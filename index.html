<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Budget Tracker – Email/Password Auth</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, Arial; max-width: 780px; margin: 2rem auto; padding: 0 1rem; }
    h1 { margin-bottom: 0.25rem; }
    .muted { color: #666; margin-top: 0; }
    form { display: grid; gap: 8px; margin: 12px 0 20px; max-width: 440px; }
    label { font-weight: 600; }
    input { padding: 8px; border: 1px solid #ccc; border-radius: 6px; }
    button { padding: 8px 12px; border-radius: 6px; border: 1px solid #ccc; background: #f6f6f6; cursor: pointer; }
    button:disabled { opacity: .6; cursor: not-allowed; }
    .row { display: flex; gap: 10px; align-items: center; }
    .card { border: 1px solid #e5e5e5; border-radius: 10px; padding: 14px; margin: 10px 0; }
    pre { background:#f6f6f6; padding:10px; border-radius:8px; overflow:auto; }
    #status.ok { color:#0a7; } #status.err { color:#c00; }
    .hide { display: none; }
  </style>
</head>
<body>
  <h1>Budget Tracker</h1>
  <p class="muted">Email + password sign in (Supabase Auth)</p>

  <!-- Status -->
  <p id="status" class="err">Not signed in.</p>
  <div class="row">
    <button id="signout" class="hide">Sign out</button>
  </div>

  <!-- Auth forms -->
  <div class="card" id="signup-card">
    <h3>Create account</h3>
    <form id="signup-form">
      <div>
        <label for="su-email">Email</label>
        <input id="su-email" type="email" placeholder="you@example.com" required />
      </div>
      <div>
        <label for="su-password">Password</label>
        <input id="su-password" type="password" placeholder="At least 6 characters" minlength="6" required />
      </div>
      <button type="submit" id="signup-btn">Sign up</button>
      <div id="signup-msg"></div>
    </form>
  </div>

  <div class="card" id="signin-card">
    <h3>Sign in</h3>
    <form id="signin-form">
      <div>
        <label for="si-email">Email</label>
        <input id="si-email" type="email" placeholder="you@example.com" required />
      </div>
      <div>
        <label for="si-password">Password</label>
        <input id="si-password" type="password" placeholder="Your password" required />
      </div>
      <button type="submit" id="signin-btn">Sign in</button>
      <div id="signin-msg"></div>
    </form>
    <button id="forgot-btn">Forgot password?</button>
  </div>

  <div class="card hide" id="forgot-card">
    <h3>Reset password</h3>
    <form id="forgot-form">
      <div>
        <label for="fp-email">Email</label>
        <input id="fp-email" type="email" placeholder="you@example.com" required />
      </div>
      <button type="submit" id="forgot-send">Send reset email</button>
      <div id="forgot-msg"></div>
    </form>
  </div>

  <div class="card hide" id="recovery-card">
    <h3>Set a new password</h3>
    <form id="recovery-form">
      <div>
        <label for="rp-password">New password</label>
        <input id="rp-password" type="password" placeholder="New password" minlength="6" required />
      </div>
      <button type="submit" id="recovery-save">Save new password</button>
      <div id="recovery-msg"></div>
    </form>
  </div>

  <!-- Read test -->
  <div class="card">
    <h3>Read test (paychecks → employer)</h3>
    <button id="read" disabled>Read employers</button>
    <pre id="out"></pre>
  </div>

  <!-- Debug -->
  <div class="card">
    <h3>Debug</h3>
    <pre id="log"></pre>
  </div>

  <script type="module">
    import { supabase } from './supabaseClient.js';

    // Elements
    const statusEl = document.getElementById('status');
    const logEl = document.getElementById('log');
    const outEl = document.getElementById('out');
    const readBtn = document.getElementById('read');
    const signoutBtn = document.getElementById('signout');

    const signupCard = document.getElementById('signup-card');
    const signinCard = document.getElementById('signin-card');
    const forgotCard = document.getElementById('forgot-card');
    const recoveryCard = document.getElementById('recovery-card');

    const signupForm = document.getElementById('signup-form');
    const signinForm = document.getElementById('signin-form');
    const forgotForm = docu
